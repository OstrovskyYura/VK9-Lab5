<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Patients</title>
    <link rel="stylesheet" th:href="@{/webjars/bootstrap/5.3.0-alpha2/dist/css/bootstrap.css}">
    <link th:rel="stylesheet" type="text/css" th:href="style.css">
</head>
<body>
<h1 th:text="|–í—Å—ñ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∏|" class="text-center"></h1>
<table class="table table-sm table-hover text-center">
    <thead class="table-dark">
    <tr>
        <th>ID</th>
        <th>–ü–Ü–ë</th>
        <th>–ê–¥—Ä–µ—Å–∞</th>
        <th>–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É</th>
        <th>–ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ø–æ—à—Ç–∞</th>
        <th>–°—Ç–∞–∂ —Ä–æ–±–æ—Ç–∏</th>
        <th>–ü–æ—Å–∞–¥–∞</th>
        <th>–í—ñ–¥–¥—ñ–ª</th>
        <th>–î—ñ—ó</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="p : ${employees}">
        <td th:text="${p.id}"></td>
        <td th:text="${p.name}"></td>
        <td th:text="${p.address}"></td>
        <td th:text="${p.phone}"></td>
        <td th:text="${p.email}"></td>
        <td th:text="${p.medicalCardNumber}"></td>
        <td th:text="${p.diagnosis}"></td>
        <td th:text="${p.department != null ? p.department.name : '–ë–µ–∑ –≤—ñ–¥–¥—ñ–ª—É'}"></td>
        <td>
            <a th:href="@{'/projects/' + ${p.id} + '/details'}" class="btn btn-outline-info">–î–µ—Ç–∞–ª—ñ</a>
            <a th:href="@{/edit_employees(id=${p.id})}" class="btn btn-secondary ">‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏</a>
            <button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#confirmDelete"
                    th:attr="data-bs-id=${p.id}, data-bs-text=${p.name}">üóë –í–∏–¥–∞–ª–∏—Ç–∏</button>
        </td>

    </tr>
    </tbody>
</table>

<!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è -->
<div class="modal fade" id="confirmDelete" tabindex="-1" aria-labelledby="confirmDeleteLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="confirmDeleteLabel">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="–ó–∞–∫—Ä–∏—Ç–∏"></button>
            </div>
            <div class="modal-body">
                –í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ <strong id="deleteText"></strong>?<br>
                –¶—é –¥—ñ—é <i>–Ω–µ –º–æ–∂–Ω–∞ —Å–∫–∞—Å—É–≤–∞—Ç–∏</i>.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                <a id="deleteButton" class="btn btn-danger">–í–∏–¥–∞–ª–∏—Ç–∏</a>
            </div>
        </div>
    </div>
</div>

<!-- –§–æ—Ä–º–∞ –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞ -->
<h2>–î–æ–¥–∞—Ç–∏ –Ω–æ–≤–æ–≥–æ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞</h2>
<form action="/add_employees" method="post">
    <input type="text" name="name" placeholder="–ü–Ü–ë" class="form-control-sm" required>
    <input type="text" name="address" placeholder="–ê–¥—Ä–µ—Å–∞" class="form-control-sm" required>
    <input type="text" name="phone" placeholder="–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É" class="form-control-sm" required>
    <input type="email" name="email" placeholder="–ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ø–æ—à—Ç–∞" class="form-control-sm" required>
    <input type="number" name="medical_card_number" placeholder="–°—Ç–∞–∂ —Ä–æ–±–æ—Ç–∏" class="form-control-sm" required>
    <input type="text" name="diagnosis" placeholder="–ü–æ—Å–∞–¥–∞" class="form-control-sm" required>

    <select name="departmentId" class="form-control-sm">
        <option value="">–í–∏–±–µ—Ä—ñ—Ç—å –≤—ñ–¥–¥—ñ–ª</option>
        <option th:each="d : ${departments}" th:value="${d.id}" th:text="${d.name}"></option>
    </select>

    <button type="submit" class="btn btn-outline-primary">‚ûï –î–æ–¥–∞—Ç–∏</button>
</form>

<!-- JS –¥–ª—è —Ä–æ–±–æ—Ç–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞ -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        var confirmDeleteModal = document.getElementById('confirmDelete');
        confirmDeleteModal.addEventListener('show.bs.modal', function (event) {
            var button = event.relatedTarget;
            var employeeId = button.getAttribute('data-bs-id');
            var employeeName = button.getAttribute('data-bs-text');

            document.getElementById('deleteText').textContent = employeeName;
            document.getElementById('deleteButton').setAttribute("href", "/delete_employees?id=" + employeeId);
        });
    });
</script>

<script th:src="@{/webjars/jquery/3.6.4/dist/jquery.js}"></script>
<script th:src="@{/webjars/popperjs__core/2.11.7/dist/umd/popper.js}"></script>
<script th:src="@{/webjars/bootstrap/5.3.0-alpha2/dist/js/bootstrap.bundle.js}"></script>
</body>
</html>
